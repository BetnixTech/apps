<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Home</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4;}
  header { background:#4CAF50; color:white; text-align:center; padding:1rem;}
  #dashboard, #editor { max-width: 900px; margin:2rem auto; background:white; padding:1rem; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1);}
  h2 { margin-top:0; }
  input, textarea, select { width:100%; padding:0.5rem; margin:0.5rem 0 1rem 0; border:1px solid #ccc; border-radius:5px;}
  button { background:#4CAF50; color:white; border:none; padding:0.6rem 1.2rem; border-radius:5px; cursor:pointer; }
  button:hover { background:#45a049; }
  .post { border-bottom:1px solid #eee; padding:1rem 0; }
  .post img { max-width:100%; margin-top:0.5rem; }
  .actions button { margin-right:0.5rem; }
  .actions button.edit { background:#2196F3; }
  .actions button.delete { background:#f44336; }
  #searchInput { margin-bottom:1rem; padding:0.5rem; border:1px solid #ccc; border-radius:5px; width:100%; }
</style>
</head>
<body>

<header>
 
</header>

<div id="dashboard">
  <h2>All Posts</h2>
  <input type="text" id="searchInput" placeholder="Search posts by title, content, or category..." oninput="renderPosts()">
  <button onclick="showEditor()">New Post</button>
  <button onclick="exportPosts()">Export Posts</button>
  <input type="file" id="importFile" style="display:none;" onchange="importPosts(event)">
  <button onclick="document.getElementById('importFile').click()">Import Posts</button>
  <div id="postsContainer"></div>
</div>

<div id="editor" style="display:none;">
  <h2 id="editorTitle">New Post</h2>
  <input type="text" id="postTitle" placeholder="Post Title">
  <textarea id="postContent" rows="5" placeholder="Write your post using Markdown..."></textarea>
  <input type="text" id="postImage" placeholder="Image URL (optional)">
  <input type="text" id="postCategory" placeholder="Category/Tags (comma-separated)">
  <button onclick="savePost()">Save Post</button>
  <button onclick="cancelEdit()">Cancel</button>
</div>

<script>
let posts = JSON.parse(localStorage.getItem('blogPosts')) || [];
let editIndex = null;

function markdownToHTML(md) {
  // Basic markdown: **bold**, *italic*, [link](url)
  return md
    .replace(/\*\*(.*?)\*\*/g, '<b>$1</b>')
    .replace(/\*(.*?)\*/g, '<i>$1</i>')
    .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank">$1</a>')
    .replace(/\n/g, '<br>');
}

function renderPosts() {
  const container = document.getElementById('postsContainer');
  const search = document.getElementById('searchInput').value.toLowerCase();
  container.innerHTML = '';
  posts.forEach((post, index) => {
    if(post.title.toLowerCase().includes(search) || 
       post.content.toLowerCase().includes(search) ||
       post.category.toLowerCase().includes(search)) {
      const div = document.createElement('div');
      div.className = 'post';
      div.innerHTML = `
        <h3>${post.title}</h3>
        <p><em>${post.category}</em></p>
        <p>${markdownToHTML(post.content)}</p>
        ${post.image ? `<img src="${post.image}">` : ''}
        <div class="actions">
          <button class="edit" onclick="editPost(${index})">Edit</button>
          <button class="delete" onclick="deletePost(${index})">Delete</button>
        </div>
      `;
      container.appendChild(div);
    }
  });
}

function showEditor() {
  document.getElementById('dashboard').style.display = 'none';
  document.getElementById('editor').style.display = 'block';
  document.getElementById('postTitle').value = '';
  document.getElementById('postContent').value = '';
  document.getElementById('postImage').value = '';
  document.getElementById('postCategory').value = '';
  document.getElementById('editorTitle').innerText = 'New Post';
  editIndex = null;
}

function cancelEdit() {
  document.getElementById('editor').style.display = 'none';
  document.getElementById('dashboard').style.display = 'block';
}

function savePost() {
  const title = document.getElementById('postTitle').value.trim();
  const content = document.getElementById('postContent').value.trim();
  const image = document.getElementById('postImage').value.trim();
  const category = document.getElementById('postCategory').value.trim();

  if(!title || !content) { alert('Title and content are required.'); return; }

  const post = { title, content, image, category };
  if(editIndex !== null) { posts[editIndex] = post; }
  else { posts.push(post); }

  localStorage.setItem('blogPosts', JSON.stringify(posts));
  cancelEdit();
  renderPosts();
}

function editPost(index) {
  editIndex = index;
  const post = posts[index];
  document.getElementById('postTitle').value = post.title;
  document.getElementById('postContent').value = post.content;
  document.getElementById('postImage').value = post.image;
  document.getElementById('postCategory').value = post.category;
  document.getElementById('editorTitle').innerText = 'Edit Post';
  document.getElementById('dashboard').style.display = 'none';
  document.getElementById('editor').style.display = 'block';
}

function deletePost(index) {
  if(confirm('Are you sure you want to delete this post?')) {
    posts.splice(index, 1);
    localStorage.setItem('blogPosts', JSON.stringify(posts));
    renderPosts();
  }
}

function exportPosts() {
  const blob = new Blob([JSON.stringify(posts, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'blogPosts.json';
  a.click();
  URL.revokeObjectURL(url);
}

function importPosts(event) {
  const file = event.target.files[0];
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const importedPosts = JSON.parse(e.target.result);
      if(Array.isArray(importedPosts)) {
        posts = importedPosts;
        localStorage.setItem('blogPosts', JSON.stringify(posts));
        renderPosts();
        alert('Posts imported successfully!');
      } else alert('Invalid JSON format.');
    } catch {
      alert('Error reading file.');
    }
  };
  reader.readAsText(file);
}

renderPosts();
</script>

</body>
</html>
